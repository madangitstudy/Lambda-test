# Logic to check for ungenerated vouchers and generate them
for voucher in retrieved_vouchers:
    if 'VoucherCode' not in voucher or voucher['VoucherCode'] is None or voucher['VoucherCode'] == "":
        # Generate the voucher
        new_voucher_code = generate_voucher_code()  # Implement your code generation logic here
        expiry_date = (datetime.utcnow() + timedelta(days=60)).strftime('%Y-%m-%d %H:%M:%S')

        # Update the DynamoDB entry
        table.update_item(
            Key={'PNR': voucher['PNR']},
            UpdateExpression='SET VoucherCode = :val1, VoucherExpiryDate = :val2',
            ExpressionAttributeValues={
                ':val1': new_voucher_code,
                ':val2': expiry_date
            }
        )

        # Add to generated vouchers list
        generated_vouchers.append({
            'PNR': voucher['PNR'],
            'VoucherCode': new_voucher_code,
            'ExpiryDate': expiry_date
        })
