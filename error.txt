def generate_voucher(passenger):
    # Prepare the request payload for Amelia API
    payload = {
        "passengerFirstName": passenger["firstName"],
        "passengerLastName": passenger["lastName"],
        "expiryDate": (datetime.now() + timedelta(days=30)).strftime("%Y-%m-%d"),
        "bookingWindow": "None",
        "voucherValue": "60 CAD",
        "pnr": passenger["pnr"]
    }

    headers = {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer YOUR_AMELIA_API_KEY'
    }
    
    data = json.dumps(payload).encode('utf-8')
    req = urllib.request.Request(AMELIA_API_URL, data=data, headers=headers, method='POST')
    
    try:
        print(f"Sending voucher generation request to {AMELIA_API_URL} with payload: {payload}")  # Log request details
        with urllib.request.urlopen(req) as response:
            if response.status == 201:
                # Voucher created successfully
                voucher_data = json.loads(response.read())
                print(f"Voucher generated: {voucher_data}")  # Log voucher details
                return voucher_data
            else:
                print(f"Error generating voucher for {passenger['firstName']} {passenger['lastName']}: {response.status}")
                return None
    except Exception as e:
        print(f"Error generating voucher: {e}")
        return None
